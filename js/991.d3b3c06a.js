"use strict";(self["webpackChunkzhshangcheng"]=self["webpackChunkzhshangcheng"]||[]).push([[991],{1991:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var i=function(){var e=this,t=e._self._c;return t("div",[t("van-nav-bar",{attrs:{title:"会员登录","left-arrow":""},on:{"click-left":function(t){return e.$router.back()}}}),t("div",{staticClass:"main"},[t("div",{staticClass:"bigtitle"},[e._v("手机号登录")]),t("div",{staticClass:"smtitle"},[e._v("未注册的手机号登录后将自动注册")]),t("div",{staticClass:"getnumber"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.userphone,expression:"userphone"}],attrs:{type:"text",placeholder:"请输入手机号"},domProps:{value:e.userphone},on:{input:function(t){t.target.composing||(e.userphone=t.target.value)}}})]),t("div",{staticClass:"getnumber"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.usercode,expression:"usercode"}],attrs:{type:"text",placeholder:"请输入图形验证码"},domProps:{value:e.usercode},on:{input:function(t){t.target.composing||(e.usercode=t.target.value)}}}),e.pigimg?t("img",{attrs:{src:e.pigimg},on:{click:e.getcodeimg}}):e._e()]),t("div",{staticClass:"getnumber"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.textcode,expression:"textcode"}],attrs:{type:"text",placeholder:"请输入短信验证码"},domProps:{value:e.textcode},on:{input:function(t){t.target.composing||(e.textcode=t.target.value)}}}),t("button",{on:{click:e.getcode}},[e._v(" "+e._s(e.second===e.sumsecond?"获取验证码":`${e.second}秒后获取验证码`)+" ")])]),t("div",{staticClass:"button"},[t("van-button",{attrs:{size:"large",round:"",color:"linear-gradient(to right, #ecb43b, #fe9312)"},on:{click:e.login}},[e._v("登录")])],1)])],1)},o=[],a=(s(9704),s(1981)),n=s(8782);const c=()=>n.A.get("/captcha/image"),r=(e,t,s)=>n.A.post("/captcha/sendSmsCaptcha",{form:{captchaCode:e,captchaKey:t,mobile:s}}),d=(e,t)=>n.A.post("/passport/login",{form:{smsCode:e,mobile:t,isParty:!1,partyData:{}}});var u={name:"LoginIndex",data(){return{pigkey:"",pigimg:"",usercode:"",userphone:"",textcode:"",sumsecond:60,second:60,settime1:null}},created(){this.getcodeimg()},methods:{async getcodeimg(){const{data:{base64:e,key:t}}=await c();this.pigimg=e,this.pigkey=t,(0,a.A)("获图形验证码成功")},async getcode(){this.checkcode()&&null===this.settime1&&this.second===this.sumsecond&&(await r(this.usercode,this.pigkey,this.userphone),(0,a.A)("获取短信验证码成功 注意短信查收~"),this.settime1=setInterval((()=>{this.second--,0===this.second&&(clearInterval(this.settime1),this.second=this.sumsecond,this.settime1=null)}),1e3))},checkcode(){return/^1[3-9]\d{9}$/.test(this.userphone)?!!/^\w{4}$/.test(this.usercode)||((0,a.A)("请输入正确的图形验证码"),!1):((0,a.A)("请输入正确的手机号"),!1)},async login(){if(!this.checkcode())return;if(!/^\d{6}$/.test(this.textcode))return void(0,a.A)("请输入正确的验证码");const e=await d(this.textcode,this.userphone);this.$store.commit("user/setuserinfo",e.data);const t=this.$route.query.backurl||"/";this.$router.replace(t),(0,a.A)("登录成功")}},destroyed(){clearInterval(this.timer)}},l=u,h=s(1656),m=(0,h.A)(l,i,o,!1,null,"5ed05b6e",null),p=m.exports}}]);
//# sourceMappingURL=991.d3b3c06a.js.map